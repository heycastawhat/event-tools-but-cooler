<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <script src="theme.js"></script>
    <title>Event Tools</title>
</head>
<body>
    <div class="hamburger-menu left">
        <button class="hamburger-btn" onclick="toggleMenu()">&#9776;</button>
        <div id="menuDropdown" class="sidebar-menu">
            <button onclick="showNewEventModal()" class="sidebar-item">New Event</button>
            <button onclick="showCustomizeModal()" class="sidebar-item">Customize</button>
            <button onclick="showSettingsModal()" class="sidebar-item">Settings</button>
            <button onclick="showSearch()" class="sidebar-item">Search</button>
        </div>
    </div>

    <div id="newEventModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-title">Start New Event?</div>
            <div class="modal-text">This will clear all teams, scores, and schedule data.</div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="confirmNewEvent()">Yes, Start Fresh</button>
                <button class="btn btn-secondary" onclick="closeNewEventModal()">Cancel</button>
            </div>
        </div>
    </div>

    <div id="customizeModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-title">Customize</div>
            <div class="customize-options">
                <div class="customize-group">
                    <label>Accent Color</label>
                    <div class="color-options">
                        <button class="color-swatch" style="background: #58a6ff;" onclick="setAccentColor('#58a6ff')" data-color="#58a6ff"></button>
                        <button class="color-swatch" style="background: #f78166;" onclick="setAccentColor('#f78166')" data-color="#f78166"></button>
                        <button class="color-swatch" style="background: #a371f7;" onclick="setAccentColor('#a371f7')" data-color="#a371f7"></button>
                        <button class="color-swatch" style="background: #3fb950;" onclick="setAccentColor('#3fb950')" data-color="#3fb950"></button>
                        <button class="color-swatch" style="background: #f0883e;" onclick="setAccentColor('#f0883e')" data-color="#f0883e"></button>
                        <button class="color-swatch" style="background: #db61a2;" onclick="setAccentColor('#db61a2')" data-color="#db61a2"></button>
                    </div>
                </div>
                <div class="customize-group">
                    <label>Font Size</label>
                    <div class="font-size-options">
                        <button class="btn btn-secondary font-size-btn" onclick="setFontSize('small')" data-size="small">Small</button>
                        <button class="btn btn-secondary font-size-btn" onclick="setFontSize('medium')" data-size="medium">Medium</button>
                        <button class="btn btn-secondary font-size-btn" onclick="setFontSize('large')" data-size="large">Large</button>
                    </div>
                </div>
                <div class="customize-group">
                    <label>Theme</label>
                    <div class="theme-options">
                        <button class="btn btn-secondary theme-btn" onclick="setTheme('dark')" data-theme="dark">Dark</button>
                        <button class="btn btn-secondary theme-btn" onclick="setTheme('light')" data-theme="light">Light</button>
                    </div>
                </div>
            </div>
            <div class="modal-buttons" style="margin-top: 1.5rem;">
                <button class="btn btn-secondary" onclick="closeCustomizeModal()">Done</button>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-title">Settings</div>
            <div class="customize-options">
                <div class="customize-group">
                    <div class="setting-row">
                        <label>Sound Effects</label>
                        <button class="toggle-btn" id="soundToggle" onclick="toggleSetting('sound')">
                            <span class="toggle-slider"></span>
                        </button>
                    </div>
                </div>
                <div class="customize-group">
                    <div class="setting-row">
                        <label>Vibration</label>
                        <button class="toggle-btn" id="vibrationToggle" onclick="toggleSetting('vibration')">
                            <span class="toggle-slider"></span>
                        </button>
                    </div>
                </div>
                <div class="customize-group">
                    <div class="setting-row">
                        <label>Confirm before clearing</label>
                        <button class="toggle-btn" id="confirmToggle" onclick="toggleSetting('confirm')">
                            <span class="toggle-slider"></span>
                        </button>
                    </div>
                </div>
                <div class="customize-group" style="border-top: 1px solid var(--border); padding-top: 1rem; margin-top: 0.5rem;">
                    <label>Data</label>
                    <div class="flex gap-2 mt-2">
                        <button class="btn btn-secondary" onclick="exportData()" style="flex: 1;">Export</button>
                        <button class="btn btn-secondary" onclick="importData()" style="flex: 1;">Import</button>
                    </div>
                </div>
            </div>
            <div class="modal-buttons" style="margin-top: 1.5rem;">
                <button class="btn btn-secondary" onclick="closeSettingsModal()">Done</button>
            </div>
        </div>
    </div>

    <div id="searchModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 450px;">
            <input type="text" id="searchInput" placeholder="Search tools and features..." oninput="filterSearch()" autofocus style="width: 100%; margin-bottom: 1rem;">
            <div id="searchResults" class="search-results"></div>
        </div>
    </div>

    <div id="onboarding" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 450px;">
            <div class="onboard-progress">
                <div class="onboard-dots">
                    <span class="onboard-dot active" data-step="0"></span>
                    <span class="onboard-dot" data-step="1"></span>
                    <span class="onboard-dot" data-step="2"></span>
                    <span class="onboard-dot" data-step="3"></span>
                </div>
            </div>

            <!-- Step 0: Welcome -->
            <div class="onboard-step" data-step="0">
                <div class="modal-title">Welcome to Event Tools</div>
                <div class="modal-text">Let's get your event set up in just a few steps.</div>
            </div>

            <!-- Step 1: Teams -->
            <div class="onboard-step" data-step="1" style="display: none;">
                <div class="modal-title">Add Participants</div>
                <div class="modal-text">Enter the names of everyone at your event, one per line.</div>
                <textarea id="onboardPeople" placeholder="Alice&#10;Bob&#10;Charlie&#10;..." rows="6" style="width: 100%; resize: vertical;"></textarea>
            </div>

            <!-- Step 2: Appearance -->
            <div class="onboard-step" data-step="2" style="display: none;">
                <div class="modal-title">Appearance</div>
                <div class="modal-text">Customise the look and feel.</div>
                <div class="customize-options">
                    <div class="customize-group">
                        <label>Accent Color</label>
                        <div class="color-options">
                            <button class="color-swatch" style="background: #58a6ff;" onclick="setAccentColor('#58a6ff')" data-color="#58a6ff"></button>
                            <button class="color-swatch" style="background: #f78166;" onclick="setAccentColor('#f78166')" data-color="#f78166"></button>
                            <button class="color-swatch" style="background: #a371f7;" onclick="setAccentColor('#a371f7')" data-color="#a371f7"></button>
                            <button class="color-swatch" style="background: #3fb950;" onclick="setAccentColor('#3fb950')" data-color="#3fb950"></button>
                            <button class="color-swatch" style="background: #f0883e;" onclick="setAccentColor('#f0883e')" data-color="#f0883e"></button>
                            <button class="color-swatch" style="background: #db61a2;" onclick="setAccentColor('#db61a2')" data-color="#db61a2"></button>
                        </div>
                    </div>
                    <div class="customize-group">
                        <label>Theme</label>
                        <div class="theme-options">
                            <button class="btn btn-secondary theme-btn" onclick="setTheme('dark')" data-theme="dark">Dark</button>
                            <button class="btn btn-secondary theme-btn" onclick="setTheme('light')" data-theme="light">Light</button>
                        </div>
                    </div>
                    <div class="customize-group">
                        <label>Font Size</label>
                        <div class="font-size-options">
                            <button class="btn btn-secondary font-size-btn" onclick="setFontSize('small')" data-size="small">Small</button>
                            <button class="btn btn-secondary font-size-btn" onclick="setFontSize('medium')" data-size="medium">Medium</button>
                            <button class="btn btn-secondary font-size-btn" onclick="setFontSize('large')" data-size="large">Large</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- schedule onboarding removed -->

            <div class="onboard-nav">
                <div></div>
                <div class="flex gap-2">
                    <button class="btn btn-secondary" id="onboardBack" onclick="onboardPrev()" style="display: none;">Back</button>
                    <button class="btn btn-primary" id="onboardNext" onclick="onboardNext()">Get Started</button>
                </div>
            </div>
        </div>
    </div>

    <input type="file" id="importInput" accept=".json" style="display: none;" onchange="handleImport(event)">

    <div class="container flex flex-col items-center" style="justify-content: center; min-height: 100vh;">
        <h1>Event tools</h1>
        <p class="text-muted mb-4">Tools for events</p>
        <div class="flex gap-2" style="flex-wrap: wrap; justify-content: center;">
            <button class="btn btn-secondary" onclick="window.location.href='teamgen.html'">Team Generator</button>
            <button class="btn btn-secondary" onclick="window.location.href='scoring.html'">Scoring</button>
            <button class="btn btn-secondary" onclick="window.location.href='timer.html'">Timer</button>
            <!-- schedule removed -->
            <button class="btn btn-secondary" onclick="window.location.href='picker.html'">Random Picker</button>
            <button class="btn btn-secondary" onclick="window.location.href='notes.html'">Notes</button>
        </div>
        <div class="flex gap-2 mt-4" style="flex-wrap: wrap; justify-content: center;">
            <button class="btn btn-primary" onclick="window.location.href='controller.html'" style="padding: 1rem 2rem;">Controller</button>
            <button class="btn btn-secondary" onclick="window.open('display.html', '_blank')" style="padding: 1rem 2rem;">Open Display</button>
        </div>
        <div id="networkInfo" class="mt-4 text-center" style="max-width: 400px; display: none;">
            <p class="text-muted text-sm mb-2">Open on your phone to control the display:</p>
            <div style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 0.75rem; font-family: monospace; font-size: 0.9rem; color: var(--accent); user-select: all; cursor: pointer;" onclick="navigator.clipboard.writeText(this.textContent.trim())" title="Click to copy" id="networkURL"></div>
            <p class="text-muted text-sm mt-2" style="font-size: 0.75rem;">Both devices must be on the same Wi-Fi.</p>
        </div>
        <button class="btn btn-secondary mt-4" onclick="playAttention()" style="padding: 1rem 2rem;">
            Attention
        </button>
    </div>

    <script>
        (function() {
            const host = location.hostname;
            if (host !== 'localhost' && host !== '127.0.0.1') {
                const url = location.origin + '/controller.html';
                document.getElementById('networkURL').textContent = url;
                document.getElementById('networkInfo').style.display = 'block';
            }
        })();

        function toggleMenu() {
            const menu = document.getElementById('menuDropdown');
            if (menu.classList.contains('open')) {
                menu.classList.remove('open');
                document.body.style.overflow = '';
            } else {
                menu.classList.add('open');
                document.body.style.overflow = 'hidden';
            }
        }

        // Close sidebar when clicking outside or on menu item
        document.addEventListener('click', (e) => {
            const menu = document.getElementById('menuDropdown');
            const hamburger = e.target.closest('.hamburger-menu');
            if (!hamburger && menu.classList.contains('open')) {
                menu.classList.remove('open');
                document.body.style.overflow = '';
            }
        });
        // Also close sidebar when clicking a menu item
        document.querySelectorAll('.sidebar-item').forEach(btn => {
            btn.addEventListener('click', () => {
                document.getElementById('menuDropdown').classList.remove('open');
                document.body.style.overflow = '';
            });
        });

        function showNewEventModal() {
            document.getElementById('newEventModal').style.display = 'flex';
        }

        function closeNewEventModal() {
            document.getElementById('newEventModal').style.display = 'none';
        }

        function confirmNewEvent() {
            localStorage.removeItem('eventToolsTeams');
            localStorage.removeItem('eventToolsScoring');
            // schedule removed
            localStorage.removeItem('eventToolsPicker');
            localStorage.removeItem('eventToolsParticipants');
            localStorage.removeItem('eventTools_onboarded');
            closeNewEventModal();
            startOnboarding();
        }

        function showCustomizeModal() {
            document.getElementById('customizeModal').style.display = 'flex';
            updateCustomizeSelection();
        }

        function closeCustomizeModal() {
            document.getElementById('customizeModal').style.display = 'none';
        }

        function setAccentColor(color) {
            document.documentElement.style.setProperty('--accent', color);
            localStorage.setItem('eventToolsAccent', color);
            updateCustomizeSelection();
        }

        function setFontSize(size) {
            const sizes = { small: '14px', medium: '16px', large: '18px' };
            document.documentElement.style.setProperty('--base-font-size', sizes[size]);
            localStorage.setItem('eventToolsFontSize', size);
            updateCustomizeSelection();
        }

        function setTheme(theme) {
            if (theme === 'light') {
                document.documentElement.style.setProperty('--bg-primary', '#ffffff');
                document.documentElement.style.setProperty('--bg-secondary', '#f6f8fa');
                document.documentElement.style.setProperty('--bg-tertiary', '#eaeef2');
                document.documentElement.style.setProperty('--text-primary', '#1f2328');
                document.documentElement.style.setProperty('--text-secondary', '#656d76');
                document.documentElement.style.setProperty('--text-muted', '#8b949e');
                document.documentElement.style.setProperty('--border', '#d0d7de');
            } else {
                document.documentElement.style.setProperty('--bg-primary', '#0d1117');
                document.documentElement.style.setProperty('--bg-secondary', '#161b22');
                document.documentElement.style.setProperty('--bg-tertiary', '#21262d');
                document.documentElement.style.setProperty('--text-primary', '#e6edf3');
                document.documentElement.style.setProperty('--text-secondary', '#8b949e');
                document.documentElement.style.setProperty('--text-muted', '#6e7681');
                document.documentElement.style.setProperty('--border', '#30363d');
            }
            localStorage.setItem('eventToolsTheme', theme);
            updateCustomizeSelection();
        }

        function updateCustomizeSelection() {
            const accent = localStorage.getItem('eventToolsAccent') || '#58a6ff';
            const fontSize = localStorage.getItem('eventToolsFontSize') || 'medium';
            const theme = localStorage.getItem('eventToolsTheme') || 'dark';

            document.querySelectorAll('.color-swatch').forEach(el => {
                el.classList.toggle('active', el.dataset.color === accent);
            });
            document.querySelectorAll('.font-size-btn').forEach(el => {
                el.classList.toggle('active', el.dataset.size === fontSize);
            });
            document.querySelectorAll('.theme-btn').forEach(el => {
                el.classList.toggle('active', el.dataset.theme === theme);
            });
        }

        function loadCustomization() {
            const accent = localStorage.getItem('eventToolsAccent');
            const fontSize = localStorage.getItem('eventToolsFontSize');
            const theme = localStorage.getItem('eventToolsTheme');
            if (accent) setAccentColor(accent);
            if (fontSize) setFontSize(fontSize);
            if (theme) setTheme(theme);
        }

        loadCustomization();

        function showSettingsModal() {
            document.getElementById('settingsModal').style.display = 'flex';
            updateSettingsToggles();
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        function toggleSetting(setting) {
            const key = `eventTools_${setting}`;
            const defaultOn = ['sound', 'vibration', 'confirm'];
            const current = defaultOn.includes(setting)
                ? localStorage.getItem(key) !== 'false'
                : localStorage.getItem(key) === 'true';
            localStorage.setItem(key, !current);
            updateSettingsToggles();
        }

        function updateSettingsToggles() {
            const settings = ['sound', 'vibration', 'confirm'];
            settings.forEach(setting => {
                const enabled = localStorage.getItem(`eventTools_${setting}`) !== 'false';
                const toggle = document.getElementById(`${setting}Toggle`);
                if (toggle) toggle.classList.toggle('active', enabled);
            });
            
        }

        function getSettings() {
            return {
                sound: localStorage.getItem('eventTools_sound') !== 'false',
                vibration: localStorage.getItem('eventTools_vibration') !== 'false',
                confirm: localStorage.getItem('eventTools_confirm') !== 'false'
            };
        }

        function exportData() {
            const data = {
                teams: localStorage.getItem('eventToolsTeams'),
                scoring: localStorage.getItem('eventToolsScoring'),
                // schedule removed
                notes: localStorage.getItem('eventToolsNotes'),
                settings: {
                    accent: localStorage.getItem('eventToolsAccent'),
                    fontSize: localStorage.getItem('eventToolsFontSize'),
                    theme: localStorage.getItem('eventToolsTheme'),
                    sound: localStorage.getItem('eventTools_sound'),
                    vibration: localStorage.getItem('eventTools_vibration'),
                    confirm: localStorage.getItem('eventTools_confirm')
                }
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `event-tools-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importData() {
            document.getElementById('importInput').click();
        }

        function handleImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.teams) localStorage.setItem('eventToolsTeams', data.teams);
                    if (data.scoring) localStorage.setItem('eventToolsScoring', data.scoring);
                    // schedule removed
                    if (data.notes) localStorage.setItem('eventToolsNotes', data.notes);
                    if (data.settings) {
                        if (data.settings.accent) localStorage.setItem('eventToolsAccent', data.settings.accent);
                        if (data.settings.fontSize) localStorage.setItem('eventToolsFontSize', data.settings.fontSize);
                        if (data.settings.theme) localStorage.setItem('eventToolsTheme', data.settings.theme);
                        if (data.settings.sound) localStorage.setItem('eventTools_sound', data.settings.sound);
                        if (data.settings.vibration) localStorage.setItem('eventTools_vibration', data.settings.vibration);
                        if (data.settings.confirm) localStorage.setItem('eventTools_confirm', data.settings.confirm);
                    }
                    loadCustomization();
                    alert('Data imported successfully!');
                } catch (err) {
                    alert('Invalid backup file');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // Search
        const searchItems = [
            { name: 'Team Generator', type: 'tool', action: () => window.location.href = 'teamgen.html' },
            { name: 'Scoring', type: 'tool', action: () => window.location.href = 'scoring.html' },
            { name: 'Timer', type: 'tool', action: () => window.location.href = 'timer.html' },
            // schedule removed
            { name: 'Random Picker', type: 'tool', action: () => window.location.href = 'picker.html' },
            { name: 'Notes', type: 'tool', action: () => window.location.href = 'notes.html' },
            { name: 'Controller', type: 'tool', action: () => window.location.href = 'controller.html' },
            { name: 'Display', type: 'tool', action: () => window.open('display.html', '_blank') },
            { name: 'New Event', type: 'action', action: () => { closeSearch(); showNewEventModal(); } },
            { name: 'Customize', type: 'action', action: () => { closeSearch(); showCustomizeModal(); } },
            { name: 'Attention', type: 'action', action: () => { closeSearch(); playAttention(); } },
            { name: 'Experimental Features', type: 'feature', action: () => { toggleSetting('experimental'); filterSearch(); }, isToggle: true, getState: () => localStorage.getItem('eventTools_experimental') === 'true' },
            { name: 'Sound Effects', type: 'feature', action: () => { toggleSetting('sound'); filterSearch(); }, isToggle: true, getState: () => localStorage.getItem('eventTools_sound') !== 'false' },
            { name: 'Vibration', type: 'feature', action: () => { toggleSetting('vibration'); filterSearch(); }, isToggle: true, getState: () => localStorage.getItem('eventTools_vibration') !== 'false' },
            { name: 'Confirm before clearing', type: 'feature', action: () => { toggleSetting('confirm'); filterSearch(); }, isToggle: true, getState: () => localStorage.getItem('eventTools_confirm') !== 'false' },
            { name: 'Dark Theme', type: 'feature', action: () => { setTheme('dark'); filterSearch(); } },
            { name: 'Light Theme', type: 'feature', action: () => { setTheme('light'); filterSearch(); } },
        ];

        function showSearch() {
            document.getElementById('searchModal').style.display = 'flex';
            const input = document.getElementById('searchInput');
            input.value = '';
            input.focus();
            filterSearch();
        }

        function closeSearch() {
            document.getElementById('searchModal').style.display = 'none';
        }

        document.getElementById('searchModal').addEventListener('click', (e) => {
            if (e.target.id === 'searchModal') closeSearch();
        });

        function filterSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const results = document.getElementById('searchResults');

            if (!query) {
                results.innerHTML = '<div class="text-muted text-center" style="padding: 1rem;">Start typing to search...</div>';
                return;
            }

            const experimentalEnabled = localStorage.getItem('eventTools_experimental') === 'true';
            const filtered = searchItems.filter(item => {
                if (item.requiresExperimental && !experimentalEnabled) return false;
                return item.name.toLowerCase().includes(query);
            });
            results.innerHTML = filtered.map((item, i) => {
                const typeLabel = item.type === 'tool' ? 'Tool' : item.type === 'experimental' ? 'Experimental' : item.type === 'feature' ? 'Feature' : 'Action';
                const toggleState = item.isToggle ? `<span class="search-toggle ${item.getState() ? 'on' : ''}">${item.getState() ? 'ON' : 'OFF'}</span>` : '';
                return `<div class="search-item" onclick="searchItems[${searchItems.indexOf(item)}].action()">
                    <div>
                        <div class="search-item-name">${item.name}</div>
                        <div class="search-item-type">${typeLabel}</div>
                    </div>
                    ${toggleState}
                </div>`;
            }).join('');

            if (filtered.length === 0) {
                results.innerHTML = '<div class="text-muted text-center" style="padding: 1rem;">No results</div>';
            }
        }

        // Onboarding
        let onboardStep = 0;
        const ONBOARD_TOTAL_STEPS = 3;

        function startOnboarding() {
            onboardStep = 0;
            document.getElementById('onboardPeople').value = '';
            showOnboardStep(0);
            document.getElementById('onboarding').style.display = 'flex';
            updateCustomizeSelection();
        }

        function skipOnboarding() {
            localStorage.setItem('eventTools_onboarded', 'true');
            document.getElementById('onboarding').style.display = 'none';
        }

        function showOnboardStep(step) {
            onboardStep = step;
            document.querySelectorAll('.onboard-step').forEach(el => {
                el.style.display = el.dataset.step == step ? 'block' : 'none';
            });
            document.querySelectorAll('.onboard-dot').forEach(el => {
                el.classList.toggle('active', parseInt(el.dataset.step) <= step);
            });

            const backBtn = document.getElementById('onboardBack');
            const nextBtn = document.getElementById('onboardNext');
            backBtn.style.display = step > 0 ? 'inline-block' : 'none';

            if (step === 0) {
                nextBtn.textContent = 'Get Started';
            } else if (step === ONBOARD_TOTAL_STEPS - 1) {
                nextBtn.textContent = 'Finish';
            } else {
                nextBtn.textContent = 'Next';
            }

            if (step === 2) updateCustomizeSelection();
        }

        function onboardNext() {
            if (onboardStep === 1) saveOnboardPeople();

            if (onboardStep >= ONBOARD_TOTAL_STEPS - 1) {
                finishOnboarding();
            } else {
                showOnboardStep(onboardStep + 1);
            }
        }

        function onboardPrev() {
            if (onboardStep > 0) showOnboardStep(onboardStep - 1);
        }

        function saveOnboardPeople() {
            const input = document.getElementById('onboardPeople').value;
            const names = input.split('\n').map(n => n.trim()).filter(n => n);
            if (names.length > 0) {
                localStorage.setItem('eventToolsParticipants', JSON.stringify(names));
                const teamSize = Math.ceil(names.length / 4);
                const shuffled = [...names].sort(() => Math.random() - 0.5);
                const teams = [];
                for (let i = 0; i < shuffled.length; i += teamSize) {
                    teams.push({
                        name: `Team ${teams.length + 1}`,
                        members: shuffled.slice(i, i + teamSize)
                    });
                }
                localStorage.setItem('eventToolsTeams', JSON.stringify(teams));
            }
        }

        // schedule onboarding removed

        function finishOnboarding() {
            localStorage.setItem('eventTools_onboarded', 'true');
            document.getElementById('onboarding').style.display = 'none';
        }

        // Auto-show on first visit
        if (!localStorage.getItem('eventTools_onboarded')) {
            startOnboarding();
        }

        function playAttention() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                }, i * 400);
            }
            
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200, 100, 200]);
            }
        }
    </script>
</body>
</html>